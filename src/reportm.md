# Simple Docker

## Part 1. Готовый докер

- Взять официальный докер образ с nginx и выкачать его при помощи ``docker pull``

![](imgs/part-1_1.1.png) 

- Проверить наличие докер образа через ``docker images``

![](imgs/part-1_2.1.png) 

- Запустить докер образ через ``docker run -d [image_id|repository]``

![](imgs/part-1_3.1.png) 

- Проверить, что образ запустился через ``docker ps``

![](imgs/part-1_4.1.png) 

- Посмотреть информацию о контейнере через ``docker inspect [container_id|container_name]``

![](imgs/part-1_5.1.png) 

- По выводу команды определить и поместить в отчёт размер контейнера, список замапленных портов и ip контейнера

![](imgs/part-1_6.1.png) 

![](imgs/part-1_6.2.png) 

![](imgs/part-1_6.3.png) 

- Остановить докер образ через ``docker stop [container_id|container_name]``

![](imgs/part-1_7.1.png) 

- Проверить, что образ остановился через ``docker ps``

![](imgs/part-1_8.1.png) 

- Запустить докер с портами 80 и 443 в контейнере, замапленными на такие же порты на локальной машине, через команду run

![](imgs/part-1_9.1.png) 

- Проверить, что в браузере по адресу localhost:80 доступна стартовая страница nginx

![](imgs/part-1_10.1.png) 

- Перезапустить докер контейнер через docker restart [container_id|container_name]

![](imgs/part-1_11.1.png) 

- Проверить любым способом, что контейнер запустился

![](imgs/part-1_12.1.png) 


## Part 2. Операции с контейнером

- Прочитать конфигурационный файл nginx.conf внутри докер контейнера через команду ``exec``

![](imgs/part-2_1.1.png)

- Создать на локальной машине файл nginx.conf

![](imgs/part-2_2.1.png)

- Настроить в нем по пути /status отдачу страницы статуса сервера nginx

![](imgs/part-2_2.2.png)

- Скопировать созданный файл nginx.conf внутрь докер образа через команду docker cp

![](imgs/part-2_3.1.png)

- Перезапустить nginx внутри докер образа через команду exec

![](imgs/part-2_4.1.png)

- Проверить, что по адресу localhost:80/status отдается страничка со статусом сервера nginx

![](imgs/part-2_5.1.png)

- Экспортировать контейнер в файл container.tar через команду export

![](imgs/part-2_6.1.png)

- Остановить контейнер

![](imgs/part-2_7.1.png)

- Удалить образ через docker rmi [image_id|repository], не удаляя перед этим контейнеры

![](imgs/part-2_8.1.png)

- Удалить остановленный контейнер

![](imgs/part-2_9.1.png)

- Импортировать контейнер обратно через команду import

![](imgs/part-2_10.1.png)

- Запустить импортированный контейнер

![](imgs/part-2_11.1.png)

- Проверить, что по адресу localhost:80/status отдается страничка со статусом сервера nginx

![](imgs/part-2_12.1.png)


## Part 3. Мини веб-сервер

 - Написать мини сервер на C и FastCgi, который будет возвращать простейшую страничку с надписью Hello World!

![](imgs/part-3_1.1.png)

- Написать свой nginx.conf, который будет проксировать все запросы с 81 порта на 127.0.0.1:8080

![](imgs/part-3_2.1.png)

- Запустить написанный мини сервер через spawn-fcgi на порту 8080

![](imgs/part-3_3.1.png)

![](imgs/part-3_3.2.png)

![](imgs/part-3_3.3.png)

- Проверить, что в браузере по localhost:81 отдается написанная вами страничка

![](imgs/part-3_4.1.png)


## Part 4. Свой докер

- Написать свой докер образ, который: собирает исходники мини сервера на FastCgi из Части 3, запускает его на 8080 порту, копирует внутрь образа написанный ./nginx/nginx.conf, запускает nginx.

![](imgs/part-4_1.1.png)

![](imgs/part-4_1.2.png)

- Собрать написанный докер образ через docker build при этом указав имя и тег

![](imgs/part-4_2.1.png)

- Запустить собранный докер образ с маппингом 81 порта на 80 на локальной машине и маппингом папки ./nginx внутрь контейнера по адресу, где лежат конфигурационные файлы nginx'а (см. Часть 2)

![](imgs/part-4_3.1.png)

- Проверить, что по localhost:80 доступна страничка написанного мини сервера

![](imgs/part-4_4.1.png)

- Дописать в ./nginx/nginx.conf проксирование странички /status, по которой надо отдавать статус сервера nginx

![](imgs/part-4_5.1.png)

- Перезапустить докер образ

![](imgs/part-4_6.1.png)

- Проверить, что теперь по localhost:80/status отдается страничка со статусом nginx

![](imgs/part-4_7.1.png)


## Part 5. Dockle

- Просканировать образ из предыдущего задания через ``dockle [image_id|repository]``

![](imgs/part-5_1.1.png)

![](imgs/part-5_1.2.png)

- Исправить образ так, чтобы при проверке через dockle не было ошибок и предупреждений

![](imgs/part-5_2.1.png)

![](imgs/part-5_2.2.png)

## Part 6. Базовый Docker Compose

- Написать файл docker-compose.yml, с помощью которого: Поднять докер контейнер из Части 5, докер контейнер с nginx, который будет проксировать все запросы с 8080 порта на 81 порт первого контейнер, замапить 8080 порт второго контейнера на 80 порт локальной машины.

![](imgs/part-6_1.1.png)

![](imgs/part-6_1.2.png)

- Остановить все запущенные контейнеры

![](imgs/part-6_2.1.png)

- Собрать и запустить проект с помощью команд ``docker-compose build`` и ``docker-compose up``

![](imgs/part-6_3.1.png)

![](imgs/part-6_4.1.png)

![](imgs/part-6_4.2.png)

- Проверить, что в браузере по localhost:80 отдается написанная вами страничка, как и ранее

![](imgs/part-6_5.1.png)
